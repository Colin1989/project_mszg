------------------------------------------------------------------------ 作者：lewis-- 日期：2013-4-4-- 描述：普通攻击被击者受伤动作----------------------------------------------------------------------StepDefender = class(BattleStep)--构造function StepDefender:ctor()	self.mDefender 	= nil		--受击的角色	self.mDamage	= nil		--伤害    self.mAttacker  = nil    self.mHealth    = nil	self.mName		= "defender"end--初始化function StepDefender:init(role, damage, attacker, health)	self.mDefender		= role	self.mDamage 	= damage    self.mAttacker  = attacker    self.mHealth    = health	self.mDuration = self.mDefender:getDuration("hit")end--执行对应的操作function StepDefender:excute()	local dp = self.mDamage:getData("damage")	if dp < 0 then		self.mDefender:changeAnimateState("hit")	end		--闪避	if self.mDamage:getData("type") == "miss" then		self.mDefender:changeBehaviorState("dodge")		local behavior = BehaviorInfo.new()		behavior:init("dodge", self.mDefender:getBottomPos())		behavior:play()	end		self.mDamage:play()	self.mDefender:settleDamage(dp)	    --[[    if self.mDamage:getData("behavior") == "prefect_defensive" then       local behavior = BehaviorInfo.new()       behavior:init("prefect_defensive", self.mDefender:getMiddlePos())       behavior:play()     end    ]]--    local dp = self.mHealth:getData("damage")	if dp ~= 0 then		self.mHealth:play()		self.mAttacker:settleDamage(dp)		--伤害反弹		if dp < 0 then			local behavior = BehaviorInfo.new()			behavior:init("rebound", self.mDefender:getMiddlePos())			behavior:play()            local effect = EffectDamageRebound.new()            effect:init(self.mDefender:getBottomPos(),self.mAttacker:getBottomPos())            effect:play()            self.mAttacker:changeAnimateState("hit")		end	endend