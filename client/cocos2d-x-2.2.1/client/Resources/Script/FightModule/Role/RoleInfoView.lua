------------------------------------------------------------------------ 作者：lewis-- 日期：2013-3-31-- 描述：角色信息视图基类----------------------------------------------------------------------RoleInfoView = class()local function buffViewUnit()	local unit = {}	unit.id				= 0	unit.label			= nil	unit.labelPos 		= nil	unit.labelScale		= 1.0		unit.icon			= nil	unit.startPos 		= nil	unit.iconPos		= nil	unit.filename 		= ""	unit.iconScale 		= 1.0    unit.buffIcon       = nil    unit.buffIconPos    = nil    unit.bufficonScale 	= 1.0	return unitendfunction RoleInfoView:getBuffType(BuffType)    if BuffType == 1 then         return "buff"    elseif BuffType == 2 then        return "debuff"    end end function RoleInfoView:ctor()	self.mRootView = nil	self.mBuffView = {}	self.mBuffView["buff"]	= {} -- buffViewUnit()	self.mBuffView["debuff"]	= {} -- buffViewUnit()endfunction RoleInfoView:cleanup()endfunction RoleInfoView:update(param)	if param == "all" then		self:updateAll()	elseif param == "skill" then		self:updateSkill()	elseif param == "buff" then		self:updateBuff()	elseif param == "attr" then		self:updateAttr()	endend--更新全部function RoleInfoView:updateAll()end--更新主要属性function RoleInfoView:updateAttr()end--更新bufffunction RoleInfoView:updateBuff()end--更新技能function RoleInfoView:updateSkill()end--取消选中所有技能function RoleInfoView:unselectAllSkill()endfunction RoleInfoView:createBuffLabel()	for key, value in pairs(self.mBuffView) do        --icon        local buffIcon = CCSprite:create("status_"..key..".png")        buffIcon:setPosition(value.buffIconPos)        buffIcon:setScale(value.bufficonScale)        self.mRootView:addChild(buffIcon)        value.buffIcon = buffIcon        --buff数量		local label = CCLabelAtlas:create("0", "num_black.png", 24, 32, 48)		self.mRootView:addChild(label)		label:setPosition(value.labelPos)		label:setScale(value.labelScale)		label:setAnchorPoint(ccp(0.5, 0.5))		label:setVisible(true)		value.label = label	endend--buff图标idel动画local function buffIconAction(sprite)	--local act1 = CCFadeTo:create(0.5, 128)	--local act2 = CCFadeTo:create(0.2, 255)	--sprite:runAction(CCRepeatForever:create(CCSequence:createWithTwoActions(act1, act2)))    sprite:removeFromParentAndCleanup(true)    sprite = nilend--buff图标进场动作 function buffIconEnterAction(sprite, startPos, destPos, destScale)	sprite:setPosition(startPos)	sprite:setScale(1.0)	local scale = 3.0	local arr = CCArray:create()    arr:addObject(CCEaseBackInOut:create(CCScaleBy:create(1.1, scale)))	local act1 = CCEaseBackInOut:create(CCScaleBy:create(0.4, destScale / scale))	local act2 = CCMoveTo:create(0.5, destPos)	arr:addObject(CCSpawn:createWithTwoActions(act1, act2))    arr:addObject(CCCallFuncN:create(buffIconAction))	sprite:runAction(CCSequence:create(arr))end--更新buff单元function RoleInfoView:updateBuffUnit(idx,amount)    local unit = self.mBuffView[idx]	if unit.label ~= nil then		if amount  >= 0 then			unit.label:setString(string.format("%d", amount))		end	endend --标签着色function RoleInfoView:labelOnColor(label, color)	if color == "green" then		label:setColor(ccc3(0, 255, 0))	elseif color == "red" then		label:setColor(ccc3(255, 0, 0))	else		label:setColor(ccc3(255, 255, 255))	endend